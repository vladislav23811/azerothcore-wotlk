# Web Server Setup Guide

## ğŸ“‹ What You Need on Your Web Server

Your web server (XAMPP at `C:\xampp\htdocs\`) needs these files and structure:

```
C:\xampp\htdocs\
â”œâ”€â”€ WOTLKHD.zip              # Full game client ZIP (optional - if using ZIP download)
â”œâ”€â”€ patches\
â”‚   â”œâ”€â”€ version.txt          # Patch version (timestamp) - AUTO-GENERATED by server
â”‚   â””â”€â”€ latest\
â”‚       â””â”€â”€ patch-Z.MPQ      # Latest patch file - AUTO-COPIED by server
â””â”€â”€ (optional: extracted WoW folder)
    â””â”€â”€ WoW\                 # If serving extracted files instead of ZIP
        â”œâ”€â”€ Wow.exe
        â”œâ”€â”€ Data\
        â””â”€â”€ ...
```

## ğŸ”§ Server-Side Setup

### 1. Configure Server to Copy Patches

In `mod-progressive-systems.conf`:

```ini
# Web Server Path (for launcher auto-updates)
ProgressiveSystems.DBC.WebServerPath = C:/xampp/htdocs
```

**This makes the server automatically:**
- Copy `patches/patch-Z.MPQ` to `C:/xampp/htdocs/patches/latest/patch-Z.MPQ`
- Update `C:/xampp/htdocs/patches/version.txt` with timestamp

### 2. Place Game Files

**Option A: ZIP File (Recommended)**
- Place `WOTLKHD.zip` in `C:\xampp\htdocs\WOTLKHD.zip`
- Launcher downloads and extracts it

**Option B: Extracted Folder**
- Extract WoW to `C:\xampp\htdocs\WoW\`
- Launcher downloads files individually (slower)

### 3. Start XAMPP Apache

1. Open XAMPP Control Panel
2. Click "Start" for Apache
3. Verify: `http://localhost/` works

### 4. Test URLs

Test these URLs in browser:

- âœ… `http://localhost/WOTLKHD.zip` - Should download ZIP
- âœ… `http://localhost/patches/version.txt` - Should show timestamp
- âœ… `http://localhost/patches/latest/patch-Z.MPQ` - Should download MPQ

## ğŸ“ File Structure Details

### `patches/version.txt`
- **Format**: Unix timestamp (e.g., `1704067200`)
- **Auto-generated**: Server updates this when patch is created
- **Purpose**: Launcher compares this with local patch version

### `patches/latest/patch-Z.MPQ`
- **Source**: `patches/patch-Z.MPQ` (generated by server)
- **Auto-copied**: Server copies to web server path
- **Purpose**: Launcher downloads this file

### `WOTLKHD.zip` (Optional)
- **Purpose**: Full game client download
- **Location**: `C:\xampp\htdocs\WOTLKHD.zip`
- **Size**: Large (several GB)

## ğŸ”„ How It Works

### Server Startup:
1. Server generates `patches/patch-Z.MPQ`
2. Server copies to `C:/xampp/htdocs/patches/latest/patch-Z.MPQ`
3. Server updates `C:/xampp/htdocs/patches/version.txt`

### Launcher Startup:
1. Launcher checks `http://localhost/patches/version.txt`
2. Compares with local patch version
3. If newer, downloads `http://localhost/patches/latest/patch-Z.MPQ`
4. Places in `WoW/Data/patch-Z.MPQ`

## ğŸŒ Remote Server Setup

If using remote server (not localhost):

1. **Update launcher config:**
   ```json
   {
       "server_url": "http://your-server-ip",
       "game_zip_url": "http://your-server-ip/WOTLKHD.zip",
       "patch_version_url": "http://your-server-ip/patches/version.txt",
       "patch_download_url": "http://your-server-ip/patches/latest/patch-Z.MPQ"
   }
   ```

2. **Or use Settings dialog** in launcher GUI

3. **Place files on remote server:**
   - Same structure as localhost
   - Ensure Apache/web server is running
   - Check firewall allows HTTP access

## âœ… Verification Checklist

- [ ] XAMPP Apache is running
- [ ] `C:\xampp\htdocs\patches\` folder exists
- [ ] `C:\xampp\htdocs\patches\version.txt` exists (or will be created)
- [ ] `C:\xampp\htdocs\patches\latest\` folder exists
- [ ] `C:\xampp\htdocs\WOTLKHD.zip` exists (if using ZIP download)
- [ ] `ProgressiveSystems.DBC.WebServerPath` is set in config
- [ ] Server can write to `C:\xampp\htdocs\` (check permissions)
- [ ] Test URLs work in browser

## ğŸš¨ Troubleshooting

### "Could not connect to server"
- Check Apache is running
- Check firewall isn't blocking
- Verify URL in launcher config
- Test URL in browser

### "Patch not found"
- Check `patches/latest/patch-Z.MPQ` exists
- Check server copied patch successfully
- Check file permissions

### "Permission denied"
- Run XAMPP as administrator
- Check folder permissions
- Ensure server can write to `htdocs/patches/`

## ğŸ“ Summary

**You need to:**
1. âœ… Set `ProgressiveSystems.DBC.WebServerPath = C:/xampp/htdocs` in config
2. âœ… Place `WOTLKHD.zip` in `C:\xampp\htdocs\` (optional)
3. âœ… Start XAMPP Apache
4. âœ… Server auto-generates and copies patches

**Server automatically:**
- âœ… Generates patches
- âœ… Copies to web server
- âœ… Updates version.txt

**Launcher automatically:**
- âœ… Checks for updates
- âœ… Downloads patches
- âœ… Installs to game folder

**ZERO WORK after initial setup!** ğŸ‰

